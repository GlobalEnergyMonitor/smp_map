
    var mine = {
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              171.904255,
              -41.631992
            ],
            [
              171.897382,
              -41.630337
            ],
            [
              171.896277,
              -41.630722
            ],
            [
              171.894865,
              -41.631451
            ],
            [
              171.894648,
              -41.631573
            ],
            [
              171.890016,
              -41.633948
            ],
            [
              171.881936,
              -41.638062
            ],
            [
              171.871035,
              -41.636833
            ],
            [
              171.868134,
              -41.632477
            ],
            [
              171.867929,
              -41.632534
            ],
            [
              171.867829,
              -41.632477
            ],
            [
              171.86761,
              -41.632156
            ],
            [
              171.867849,
              -41.632061
            ],
            [
              171.867494,
              -41.631489
            ],
            [
              171.866854,
              -41.631332
            ],
            [
              171.870449,
              -41.636757
            ],
            [
              171.859586,
              -41.635265
            ],
            [
              171.858726,
              -41.63694
            ],
            [
              171.856675,
              -41.64135
            ],
            [
              171.853289,
              -41.648102
            ],
            [
              171.852575,
              -41.649525
            ],
            [
              171.852481,
              -41.650306
            ],
            [
              171.852281,
              -41.651978
            ],
            [
              171.850341,
              -41.654039
            ],
            [
              171.849616,
              -41.654808
            ],
            [
              171.849638,
              -41.659321
            ],
            [
              171.851681,
              -41.659313
            ],
            [
              171.854828,
              -41.66935
            ],
            [
              171.852072,
              -41.670013
            ],
            [
              171.853943,
              -41.674927
            ],
            [
              171.856219,
              -41.677216
            ],
            [
              171.85726,
              -41.677704
            ],
            [
              171.858041,
              -41.681877
            ],
            [
              171.859291,
              -41.686962
            ],
            [
              171.858301,
              -41.687019
            ],
            [
              171.858249,
              -41.687317
            ],
            [
              171.856175,
              -41.699181
            ],
            [
              171.852676,
              -41.698593
            ],
            [
              171.838118,
              -41.706184
            ],
            [
              171.838118,
              -41.706184
            ],
            [
              171.838118,
              -41.706184
            ],
            [
              171.850611,
              -41.712198
            ],
            [
              171.850698,
              -41.71224
            ],
            [
              171.853367,
              -41.713524
            ],
            [
              171.867792,
              -41.696689
            ],
            [
              171.871069,
              -41.692863
            ],
            [
              171.8819,
              -41.698514
            ],
            [
              171.892818,
              -41.686731
            ],
            [
              171.896956,
              -41.689583
            ],
            [
              171.901012,
              -41.683055
            ],
            [
              171.901752,
              -41.679633
            ],
            [
              171.893173,
              -41.669601
            ],
            [
              171.887698,
              -41.666917
            ],
            [
              171.886458,
              -41.666309
            ],
            [
              171.889931,
              -41.651053
            ],
            [
              171.890938,
              -41.646633
            ],
            [
              171.889969,
              -41.64505
            ],
            [
              171.89176,
              -41.642029
            ],
            [
              171.892759,
              -41.640343
            ],
            [
              171.904255,
              -41.631992
            ]
          ]
        ]
      },
      "properties": {
        "id": "M1301.B1",
        "mine feature category": "mine boundary",
        "mine feature subcategory": "surface",
        "data source date": "2025-11-09 00:00:00",
        "notes": "Figure 2.1 Map of the Stockton mine area on page 16 of 'Stockton revisited: The mine and the regulatory minefield', October 2009, https://web.archive.org/web/2/https://ttpp.nz/wp-content/uploads/2022/07/Stockton-Mine-PCE-Report.pdf shows the Stockton mine boundary. The shape of this boundary closely matches the shape of active mining permit 37150 found in the New Zealand Petroleum and Minerals Mineral Permits - Feature Layer, https://web.archive.org/web/20251114203522/https://data.nzpam.govt.nz/portal/home/item.html?id=41f8a05c44324ebcab395c44effe95d7, last updated November 9 2025. The mining permit was granted on 31 Mar 1987 and expires on 30 Mar 2027 and covers 2310.3 Ha. The area of the extracted boundary is 23.3 sq km (2,334 Ha).",
        "description": "Stockton coal mine boundary",
        "coordinates precision": "extracted",
        "GEM Mine ID": "M1301",
        "Owners": "BT Mining Ltd [100%]",
        "Owners (Non-ENG)": "",
        "Parent Company": "Bathurst Resources [65%]; Talleys Energy [35%]",
        "GEM Wiki Page (ENG)": "https://www.gem.wiki/Stockton_mine",
        "GEM Wiki Page (Non-ENG)": "",
        "Coal Grade": "Met",
        "Mine Name": "Stockton Coal Mine",
        "Country / Area": "New Zealand",
        "Last researched": "Nov 14, 2025",
        "build_version": "Coal Mine Boundaries and Methane Sources - version 1.0.0 (built on February 03 2026 17.29.55 EST)"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          171.874068,
          -41.670867
        ]
      },
      "properties": {
        "id": "M1301.P1",
        "mine feature category": "other",
        "mine feature subcategory": "preparation plant",
        "data source date": "2024-02-04 00:00:00",
        "notes": "Identified visually from Google Earth Pro satellite imagery.",
        "description": "Coal handling and preparation plant",
        "coordinates precision": "extracted",
        "GEM Mine ID": "M1301",
        "Owners": "BT Mining Ltd [100%]",
        "Owners (Non-ENG)": "",
        "Parent Company": "Bathurst Resources [65%]; Talleys Energy [35%]",
        "GEM Wiki Page (ENG)": "https://www.gem.wiki/Stockton_mine",
        "GEM Wiki Page (Non-ENG)": "",
        "Coal Grade": "Met",
        "Mine Name": "Stockton Coal Mine",
        "Country / Area": "New Zealand",
        "Last researched": "Nov 14, 2025",
        "build_version": "Coal Mine Boundaries and Methane Sources - version 1.0.0 (built on February 03 2026 17.29.55 EST)"
      }
    }
  ]
}

    var bounds = L.latLngBounds(L.latLng(-41.713524, 171.838118), L.latLng(-41.630337, 171.904255));
                        
    // create some basemap layers - use google imagery as this is what we used in research - the attribution might need more refining/research
    var googleStreet =  L.tileLayer('http://mt0.google.com/vt/lyrs=m&hl=en&x={x}&y={y}&z={z}', {maxZoom: 18, attribution: '&copy; Google Maps'})
    var googleHybrid =  L.tileLayer('http://mt0.google.com/vt/lyrs=y&hl=en&x={x}&y={y}&z={z}', {maxZoom: 18, attribution: '&copy; Google Maps'})

    var map = L.map('map', {layers: [googleStreet, googleHybrid]}).fitBounds(bounds) 

    // add basemaps layer control
    var baseMaps = {"Street view": googleStreet,"Satellite view": googleHybrid};
    var layerControl = L.control.layers(baseMaps).addTo(map);

    // add popup content
    function onEachFeature(feature, layer) {
        let popupContent = "<b><u>" + feature.properties['description'] + "</u></b><br /><br />"
        for (const [key, value] of Object.entries(feature.properties)) {
            popupContent += '<b>' + key + '</b>: ' + value + '<br />'
        }
        layer.bindPopup(popupContent, { maxHeight: 200 , maxWidth: 400})
        if (feature.properties['mine feature category'] == "mine boundary") {
           layer.setStyle({ color: '#CA4A50', fillColor: '#CA4A50', opacity: 1.0 });
        }
	}

    // add the mine layer to the map
    const mineLayer = L.geoJSON(mine, {onEachFeature}).addTo(map)

    // Add the GEM mine location as markers                   
    var GEMMineIcon = L.icon({ iconUrl: 'https://maps.google.com/mapfiles/kml/paddle/red-circle.png', iconSize:  [40, 40]});

    var GEMMine;
                        
	GEMMine = L.marker([-41.66887, 171.872278], {icon: GEMMineIcon}).addTo(map); 
	GEMMine.bindPopup('Stockton Coal Mine Operating mine');
	GEMMine.bindTooltip('Stockton Coal Mine Operating mine', { permanent: true, direction: 'right'});
	GEMMine = L.marker([-41.66887, 171.872278], {icon: GEMMineIcon}).addTo(map); 
	GEMMine.bindPopup('Stockton Coal Mine Proposed mine');
	GEMMine.bindTooltip('Stockton Coal Mine Proposed mine', { permanent: true, direction: 'right'});
