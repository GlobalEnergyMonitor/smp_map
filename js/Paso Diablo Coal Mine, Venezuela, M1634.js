
    var mine = {
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              -72.262968,
              10.980736
            ],
            [
              -72.262964,
              10.982723
            ],
            [
              -72.258384,
              10.982925
            ],
            [
              -72.25838,
              10.985331
            ],
            [
              -72.251456,
              10.985319
            ],
            [
              -72.251439,
              10.995358
            ],
            [
              -72.25282,
              10.997347
            ],
            [
              -72.254841,
              10.999233
            ],
            [
              -72.254625,
              11.000906
            ],
            [
              -72.252383,
              11.003725
            ],
            [
              -72.25025,
              11.00529
            ],
            [
              -72.249253,
              11.008604
            ],
            [
              -72.249734,
              11.019362
            ],
            [
              -72.247236,
              11.019568
            ],
            [
              -72.2473,
              11.023771
            ],
            [
              -72.249155,
              11.024264
            ],
            [
              -72.249363,
              11.027767
            ],
            [
              -72.252431,
              11.028122
            ],
            [
              -72.252354,
              11.031134
            ],
            [
              -72.249643,
              11.031059
            ],
            [
              -72.247786,
              11.031826
            ],
            [
              -72.247783,
              11.033788
            ],
            [
              -72.245995,
              11.035606
            ],
            [
              -72.246133,
              11.038898
            ],
            [
              -72.25105,
              11.042688
            ],
            [
              -72.250927,
              11.046634
            ],
            [
              -72.251223,
              11.059634
            ],
            [
              -72.249468,
              11.059631
            ],
            [
              -72.246584,
              11.066205
            ],
            [
              -72.242912,
              11.066825
            ],
            [
              -72.242748,
              11.069174
            ],
            [
              -72.236363,
              11.069634
            ],
            [
              -72.233168,
              11.071038
            ],
            [
              -72.233158,
              11.076521
            ],
            [
              -72.230923,
              11.076674
            ],
            [
              -72.231232,
              11.081688
            ],
            [
              -72.228039,
              11.081996
            ],
            [
              -72.228022,
              11.090926
            ],
            [
              -72.236802,
              11.09094
            ],
            [
              -72.237277,
              11.092977
            ],
            [
              -72.239032,
              11.09345
            ],
            [
              -72.239164,
              11.107866
            ],
            [
              -72.24076,
              11.108339
            ],
            [
              -72.241073,
              11.111944
            ],
            [
              -72.265818,
              11.111826
            ],
            [
              -72.268217,
              11.109323
            ],
            [
              -72.268226,
              11.104151
            ],
            [
              -72.271419,
              11.103686
            ],
            [
              -72.27191,
              11.096166
            ],
            [
              -72.269677,
              11.095379
            ],
            [
              -72.26984,
              11.093186
            ],
            [
              -72.281828,
              11.082709
            ],
            [
              -72.285818,
              11.082872
            ],
            [
              -72.286932,
              11.084754
            ],
            [
              -72.293957,
              11.083825
            ],
            [
              -72.293641,
              11.082102
            ],
            [
              -72.295559,
              11.080225
            ],
            [
              -72.295429,
              11.060644
            ],
            [
              -72.293356,
              11.059388
            ],
            [
              -72.293838,
              11.056883
            ],
            [
              -72.295117,
              11.055788
            ],
            [
              -72.300864,
              11.054544
            ],
            [
              -72.306775,
              11.051107
            ],
            [
              -72.307203,
              10.984686
            ],
            [
              -72.301463,
              10.981074
            ],
            [
              -72.262968,
              10.980736
            ]
          ]
        ]
      },
      "properties": {
        "id": "M1634.B1",
        "mine feature category": "mine boundary",
        "mine feature subcategory": "surface",
        "data source date": "2006-05-25 00:00:00",
        "notes": "Figure 1 Location of the Paso Diablo and Socuy mines, on page 4 of Study of Maracaibo Lake water-coal interaction, accepted 25 May 2006, https://web.archive.org/web/2/https://www.researchgate.net/publication/289181288_Study_of_Maracaibo_Lake_water-coal_interaction , includes a low resolution potential boundary of the mine. An antialiased version of the figure was used for boundary extraction.\n\nFigure 3 pg 513 of Organic petrology of Paleocene Marcelina Formation coals, Paso Diablo mine, western Venezuela: Tectonic controls on coal type, August 2007, https://web.archive.org/web/2/https://www.sciencedirect.com/science/article/abs/pii/S0166516206001078, the mine contains two pits, Baqueta Pit to the north, and Paso Diablo Pit to the south. Inspection of Google Earth Pro satellite imagery from 3/9/2025 confirms that the extracted boundary includes both pits.\n\nDue to the age of the resource used for boundary extraction, and the low resolution of the figure used, the coordinates precision has been set to 'estimated'.\n\nThe area of the boundary is approximately 81 sq km (8148 hectares).\n\nMine boundary information was challenging to find due to limited available information.\n",
        "description": "Approximate Paso Diablo mine boundary",
        "coordinates precision": "estimated",
        "GEM Mine ID": "M1634",
        "Owners": "Carbones del Guasare (CDG) [100%]",
        "Owners (Non-ENG)": "",
        "Parent Company": "Carbones del Guasare (CDG)",
        "GEM Wiki Page (ENG)": "https://www.gem.wiki/Paso_Diablo_Mine",
        "GEM Wiki Page (Non-ENG)": "https://www.gem.wiki/Mina_Paso_Diablo",
        "Coal Grade": "Met",
        "Mine Name": "Paso Diablo Coal Mine",
        "Country / Area": "Venezuela",
        "Last researched": "Sep 18, 2025",
        "build_version": "Coal Mine Boundaries and Methane Sources - version 1.0.1 (built on February 13 2026 18.38.33 EST)"
      }
    }
  ]
}
    var bounds = L.latLngBounds(L.latLng(10.980736, -72.307203), L.latLng(11.111944, -72.228022));                        
    var googleStreet =  L.tileLayer('https://mt0.google.com/vt/lyrs=m&hl=en&x={x}&y={y}&z={z}', {maxZoom: 20, attribution: '&copy; Google Maps'})
    var googleHybrid =  L.tileLayer('https://mt0.google.com/vt/lyrs=y&hl=en&x={x}&y={y}&z={z}', {maxZoom: 20, attribution: '&copy; Google Maps'})
    
    // When this map is embedded in the GEM Wiki via an iframe widget, the enclosing html css for width and height of #map does not consistently
    // come through, resulting in sometimes being 0, 0. This seems to mess fitBounds up resulting in a fully zoomed out map showing the entire planet.
    // I tried many different adjustments, but in the end chose a setView with a fixed zoom of 12 to be much more reliable.
    //var map = L.map('map', {layers: [googleHybrid]}).fitBounds(bounds) 
                        
    var map = L.map('map', {layers: [googleHybrid]}).setView([11.04634, -72.2676125], 12.0)                     
    var markerLayerGroup = L.layerGroup();
                        

    function onEachFeature(feature, layer) {
        let popupContent = "<b><u>" + feature.properties['description'] + "</u></b><br /><br />"
        let tooltipContent = feature.properties['id'] + ": " + feature.properties['description']
        for (const [key, value] of Object.entries(feature.properties)) {
            popupContent += '<b>' + key + '</b>: ' + value + '<br />'
        }
        layer.bindPopup(popupContent, { maxHeight: 200 , maxWidth: 400})
        layer.bindTooltip(tooltipContent, { permanent: false, direction: 'right'});
        if (feature.properties['mine feature category'] == "mine boundary") {
           layer.setStyle({ color: '#CA4A50', fillColor: '#CA4A50', opacity: 1.0 });
        }
        markerLayerGroup.addLayer(layer)
	}
    
    markerLayerGroup.addTo(map);
    const mineLayer = L.geoJSON(mine, {onEachFeature}).addTo(map)
    var GEMMineIcon = L.icon({ iconUrl: 'https://maps.google.com/mapfiles/kml/paddle/red-circle.png', iconSize:  [40, 40]});
    
    const myDiv = document.getElementById('map');
    const width = myDiv.offsetWidth;
    const height = myDiv.offsetHeight;
    console.log("#map width: " + width + ", height: " + height);                    

    // Create a "dummy" layer group specifically to act as the tooltip toggle switch in the control
    var tooltipToggleLayer = L.layerGroup();
    // Add event listeners to the map that listen for the toggle layer being added or removed
    map.on('layeradd', function (e) {
        if (e.layer === tooltipToggleLayer) {
            // When the "Tooltip" overlay is selected, iterate over all markers and make tooltips permanent
            markerLayerGroup.eachLayer(function (layer) {
                if (layer.getTooltip()) {
                    layer.getTooltip().options.permanent = true;
                    layer.openTooltip(); // Open the tooltip permanently
                }
            });
        }
    });
    map.on('layerremove', function (e) {
        if (e.layer === tooltipToggleLayer) {
            // When the "Tooltip" overlay is deselected, make tooltips non-permanent and close them
            markerLayerGroup.eachLayer(function (layer) {
                if (layer.getTooltip()) {
                    layer.getTooltip().options.permanent = false;
                    layer.closeTooltip();
                }
            });
        }
    });

    map.on('zoomend', function() {
        console.log("Current zoom level: " + map.getZoom());
    });

    var baseMaps = {
        "Satellite view": googleHybrid,
        "Street view": googleStreet
    };
    var overlayMaps = {
        "Labels": tooltipToggleLayer // The toggle switch for tooltips
    };
    var layerControl = L.control.layers(baseMaps, overlayMaps).addTo(map);
                        
    var GEMMine;
                        
    GEMMine = L.marker([11.039603, -72.268181], {icon: GEMMineIcon}).addTo(map); 
    GEMMine.bindPopup('Operating status(es): Operating');
    GEMMine.bindTooltip('Paso Diablo Coal Mine', { permanent: true, direction: 'right'});
