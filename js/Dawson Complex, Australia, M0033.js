
    var mine = {
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              150.055152,
              -24.915679
            ],
            [
              150.053694,
              -24.910531
            ],
            [
              150.052681,
              -24.909494
            ],
            [
              150.051846,
              -24.903337
            ],
            [
              150.050048,
              -24.897681
            ],
            [
              150.059233,
              -24.831744
            ],
            [
              150.06017,
              -24.831744
            ],
            [
              150.060331,
              -24.831609
            ],
            [
              150.060293,
              -24.831122
            ],
            [
              150.061454,
              -24.827776
            ],
            [
              150.063299,
              -24.826028
            ],
            [
              150.063029,
              -24.824063
            ],
            [
              150.061491,
              -24.822631
            ],
            [
              150.062094,
              -24.82011
            ],
            [
              150.061121,
              -24.819256
            ],
            [
              150.061004,
              -24.81903
            ],
            [
              150.061353,
              -24.816529
            ],
            [
              150.061352,
              -24.816528
            ],
            [
              150.061127,
              -24.814782
            ],
            [
              150.061242,
              -24.814439
            ],
            [
              150.061798,
              -24.812788
            ],
            [
              150.058937,
              -24.808493
            ],
            [
              150.049664,
              -24.808311
            ],
            [
              150.045915,
              -24.810249
            ],
            [
              150.046686,
              -24.775319
            ],
            [
              150.046688,
              -24.77524
            ],
            [
              150.046736,
              -24.773029
            ],
            [
              150.07635,
              -24.73987
            ],
            [
              150.078969,
              -24.722946
            ],
            [
              150.081617,
              -24.723304
            ],
            [
              150.082049,
              -24.720447
            ],
            [
              150.079354,
              -24.72045
            ],
            [
              150.079395,
              -24.720178
            ],
            [
              150.079471,
              -24.720178
            ],
            [
              150.079439,
              -24.719908
            ],
            [
              150.075764,
              -24.706355
            ],
            [
              150.075643,
              -24.706255
            ],
            [
              150.075452,
              -24.70568
            ],
            [
              150.066192,
              -24.68601
            ],
            [
              150.065741,
              -24.685049
            ],
            [
              150.068751,
              -24.665316
            ],
            [
              150.065315,
              -24.662319
            ],
            [
              150.065805,
              -24.658966
            ],
            [
              150.06585,
              -24.658661
            ],
            [
              150.066532,
              -24.653988
            ],
            [
              150.071233,
              -24.654503
            ],
            [
              150.072856,
              -24.647265
            ],
            [
              150.071581,
              -24.645991
            ],
            [
              150.075371,
              -24.621668
            ],
            [
              150.06876,
              -24.620876
            ],
            [
              150.068317,
              -24.623965
            ],
            [
              150.064794,
              -24.623543
            ],
            [
              150.064953,
              -24.622435
            ],
            [
              150.063485,
              -24.622259
            ],
            [
              150.063769,
              -24.620278
            ],
            [
              150.062598,
              -24.620137
            ],
            [
              150.062867,
              -24.618262
            ],
            [
              150.061415,
              -24.618087
            ],
            [
              150.06067,
              -24.60655
            ],
            [
              150.062414,
              -24.606145
            ],
            [
              150.060343,
              -24.59851
            ],
            [
              150.059106,
              -24.594003
            ],
            [
              150.059017,
              -24.592844
            ],
            [
              150.058289,
              -24.582067
            ],
            [
              150.059778,
              -24.569388
            ],
            [
              150.059823,
              -24.569008
            ],
            [
              150.059849,
              -24.568784
            ],
            [
              150.060206,
              -24.565741
            ],
            [
              150.060614,
              -24.564787
            ],
            [
              150.07575,
              -24.529356
            ],
            [
              150.067547,
              -24.516096
            ],
            [
              150.067097,
              -24.515368
            ],
            [
              150.067097,
              -24.51537
            ],
            [
              150.066673,
              -24.514681
            ],
            [
              150.066702,
              -24.513926
            ],
            [
              150.066797,
              -24.512995
            ],
            [
              150.066983,
              -24.512195
            ],
            [
              150.066983,
              -24.512195
            ],
            [
              150.067189,
              -24.512149
            ],
            [
              150.067413,
              -24.510375
            ],
            [
              150.067462,
              -24.509983
            ],
            [
              150.06796,
              -24.506037
            ],
            [
              150.068669,
              -24.500404
            ],
            [
              150.068382,
              -24.499338
            ],
            [
              150.068469,
              -24.498604
            ],
            [
              150.068921,
              -24.494825
            ],
            [
              150.069595,
              -24.48918
            ],
            [
              150.070159,
              -24.484455
            ],
            [
              150.070441,
              -24.482094
            ],
            [
              150.070668,
              -24.47994
            ],
            [
              150.070712,
              -24.479579
            ],
            [
              150.071854,
              -24.470387
            ],
            [
              150.072542,
              -24.464499
            ],
            [
              150.072585,
              -24.464138
            ],
            [
              150.075674,
              -24.438251
            ],
            [
              150.051235,
              -24.435761
            ],
            [
              149.960543,
              -24.326404
            ],
            [
              149.928495,
              -24.298782
            ],
            [
              149.906852,
              -24.288194
            ],
            [
              149.890511,
              -24.272312
            ],
            [
              149.888844,
              -24.283038
            ],
            [
              149.88887,
              -24.283423
            ],
            [
              149.904376,
              -24.304668
            ],
            [
              149.926572,
              -24.311433
            ],
            [
              149.958526,
              -24.342823
            ],
            [
              150.026772,
              -24.433549
            ],
            [
              150.038894,
              -24.466077
            ],
            [
              150.043855,
              -24.466726
            ],
            [
              150.047061,
              -24.497249
            ],
            [
              150.041882,
              -24.496456
            ],
            [
              150.026764,
              -24.5005
            ],
            [
              150.012072,
              -24.51349
            ],
            [
              150.007608,
              -24.517436
            ],
            [
              150.018167,
              -24.533022
            ],
            [
              150.019107,
              -24.534317
            ],
            [
              150.019234,
              -24.534503
            ],
            [
              150.019234,
              -24.534503
            ],
            [
              150.018777,
              -24.534863
            ],
            [
              150.013724,
              -24.538537
            ],
            [
              150.013705,
              -24.540864
            ],
            [
              150.013591,
              -24.570026
            ],
            [
              150.013526,
              -24.586622
            ],
            [
              150.013425,
              -24.612353
            ],
            [
              150.017132,
              -24.643429
            ],
            [
              150.02044,
              -24.671148
            ],
            [
              150.030229,
              -24.698898
            ],
            [
              150.03007,
              -24.699426
            ],
            [
              150.025421,
              -24.714941
            ],
            [
              150.020176,
              -24.732444
            ],
            [
              150.022778,
              -24.748602
            ],
            [
              150.024689,
              -24.751718
            ],
            [
              150.023541,
              -24.7557
            ],
            [
              150.02373,
              -24.768319
            ],
            [
              150.022736,
              -24.773005
            ],
            [
              150.022924,
              -24.773389
            ],
            [
              150.021951,
              -24.777892
            ],
            [
              150.021837,
              -24.778425
            ],
            [
              150.020999,
              -24.778276
            ],
            [
              150.019125,
              -24.787007
            ],
            [
              150.019017,
              -24.787947
            ],
            [
              150.019117,
              -24.788998
            ],
            [
              150.01941,
              -24.78994
            ],
            [
              150.022383,
              -24.796923
            ],
            [
              150.023616,
              -24.799795
            ],
            [
              150.024058,
              -24.800831
            ],
            [
              150.029012,
              -24.812354
            ],
            [
              150.02866,
              -24.81228
            ],
            [
              150.022355,
              -24.811529
            ],
            [
              150.022067,
              -24.811491
            ],
            [
              150.008678,
              -24.809759
            ],
            [
              150.008649,
              -24.810031
            ],
            [
              150.006075,
              -24.833586
            ],
            [
              150.002089,
              -24.870562
            ],
            [
              150.011926,
              -24.896705
            ],
            [
              150.014584,
              -24.903736
            ],
            [
              150.014908,
              -24.904595
            ],
            [
              150.024091,
              -24.928879
            ],
            [
              150.029213,
              -24.934498
            ],
            [
              150.036517,
              -24.943732
            ],
            [
              150.04077,
              -24.948411
            ],
            [
              150.033287,
              -24.954122
            ],
            [
              150.056812,
              -25.015375
            ],
            [
              150.070059,
              -25.061049
            ],
            [
              150.102602,
              -25.060425
            ],
            [
              150.098929,
              -25.051242
            ],
            [
              150.085247,
              -25.040133
            ],
            [
              150.048378,
              -24.944219
            ],
            [
              150.043554,
              -24.94164
            ],
            [
              150.047421,
              -24.917166
            ],
            [
              150.055152,
              -24.915679
            ]
          ]
        ]
      },
      "properties": {
        "id": "M0033.B1",
        "mine feature category": "mine boundary",
        "mine feature subcategory": "surface",
        "data source date": "3/2024, 9/2024",
        "notes": "From the introduction on page 4 of Dawson Mine Supporting Information for Environmental Authority Amendment Environmental Authority EPML00565813 from 9/2024, https://web.archive.org/web/2/https://australia.angloamerican.com/~/media/Files/A/Anglo-American-Group-v5/Australia/landholder-information/Dawson%20Central%20and%20North/Part%202%20%20Application%20supporting%20document.pdf, Dawson Central and North Mine (DCN) consists of the following mining leases: ML 5591, ML 5592, ML 5593, ML 5596, ML 5597, ML 5598, ML 5599, ML 5600, ML 5601, ML 5603, ML 5604, ML 5606, ML 5607, ML 5611, ML 5630, ML 5643, ML 5644, ML 5646, ML 5650, ML 5656, ML 80032, ML 80034, ML 80070, ML 80142 and ML 80146, and the following exploration leases: EPC578, EPC894, EPC895, EPC988, EPC989, EPC1068, EPC1086.\n\nFrom Section 3.1 Dawson South Mine, paragraph 3 of Supporting information for the Dawson South Mine Environmental Assessment Report from 3/2024, pages 1-2, https://web.archive.org/web/20250714134814/https://australia.angloamerican.com/~/media/Files/A/Anglo-American-Group-v5/Australia/landholder-information/dawson-south/a-ea-amd-100627125-support-info.pdf, the mining operations of Dawson South mine are located within mining leases ML 5657, ML 80160 and ML 80161.\n\nThe boundary is comprised of the above Dawson Central and North mine mining leases, and the Dawson South mine mining leases, but excludes the Moura seam gas pipeline lease ML 800032, and excludes the Dawson Central and North mine exploration leases.\n\nPetroleum leases PL 94, PL 1048 and PL 1049, and pipline leases PPL 182, PPL 61 and PPL 26 are colocated and overlapping along the western edge of the mine boundary and coal seam gas facilities are visible in the eastern area of the mine boundary that contains mining leases ML 5644 and ML 5599. Undeground coal mining stopped in 1994 at the Dawson mining complex.\n\nThe area of the mine boundary is 308 sq km.\n\nMining lease geometries were extracted from the Queensland Mining Leases dataset (https://web.archive.org/web/2/https://www.data.qld.gov.au/dataset/queensland-mining-and-exploration-tenure-series/resource/f87794b8-7b9a-4732-89bb-56ccb2228d27).",
        "description": "Dawson Complex mine boundary",
        "coordinates precision": "extracted",
        "GEM Mine ID": "M0033",
        "Owners": "Dawson Joint Venture [100%]",
        "Owners (Non-ENG)": "",
        "Parent Company": "Anglo American [51%]; Mitsui Holdings [49%]",
        "GEM Wiki Page (ENG)": "https://www.gem.wiki/Dawson_mine",
        "GEM Wiki Page (Non-ENG)": "",
        "Coal Grade": "Thermal & Met",
        "Mine Name": "Dawson Complex",
        "Country / Area": "Australia",
        "Last researched": "Jul 14, 2025",
        "build_version": "Coal Mine Boundaries and Methane Sources - version 1.0.1 (built on February 13 2026 18.38.33 EST)"
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          150.063479,
          -24.526244
        ]
      },
      "properties": {
        "id": "M0033.P1",
        "mine feature category": "other",
        "mine feature subcategory": "preparation plant",
        "data source date": "2023-12-05 00:00:00",
        "notes": "Identified visually from Google Earth Pro satellite imagery.",
        "description": "coal prep plant",
        "coordinates precision": "extracted",
        "GEM Mine ID": "M0033",
        "Owners": "Dawson Joint Venture [100%]",
        "Owners (Non-ENG)": "",
        "Parent Company": "Anglo American [51%]; Mitsui Holdings [49%]",
        "GEM Wiki Page (ENG)": "https://www.gem.wiki/Dawson_mine",
        "GEM Wiki Page (Non-ENG)": "",
        "Coal Grade": "Thermal & Met",
        "Mine Name": "Dawson Complex",
        "Country / Area": "Australia",
        "Last researched": "Jul 14, 2025",
        "build_version": "Coal Mine Boundaries and Methane Sources - version 1.0.1 (built on February 13 2026 18.38.33 EST)"
      }
    }
  ]
}
    var bounds = L.latLngBounds(L.latLng(-25.061049, 149.888844), L.latLng(-24.272312, 150.102602));                        
    var googleStreet =  L.tileLayer('https://mt0.google.com/vt/lyrs=m&hl=en&x={x}&y={y}&z={z}', {maxZoom: 20, attribution: '&copy; Google Maps'})
    var googleHybrid =  L.tileLayer('https://mt0.google.com/vt/lyrs=y&hl=en&x={x}&y={y}&z={z}', {maxZoom: 20, attribution: '&copy; Google Maps'})
    
    // When this map is embedded in the GEM Wiki via an iframe widget, the enclosing html css for width and height of #map does not consistently
    // come through, resulting in sometimes being 0, 0. This seems to mess fitBounds up resulting in a fully zoomed out map showing the entire planet.
    // I tried many different adjustments, but in the end chose a setView with a fixed zoom of 12 to be much more reliable.
    //var map = L.map('map', {layers: [googleHybrid]}).fitBounds(bounds) 
                        
    var map = L.map('map', {layers: [googleHybrid]}).setView([-24.6666805, 149.995723], 9.0)                     
    var markerLayerGroup = L.layerGroup();
                        

    function onEachFeature(feature, layer) {
        let popupContent = "<b><u>" + feature.properties['description'] + "</u></b><br /><br />"
        let tooltipContent = feature.properties['id'] + ": " + feature.properties['description']
        for (const [key, value] of Object.entries(feature.properties)) {
            popupContent += '<b>' + key + '</b>: ' + value + '<br />'
        }
        layer.bindPopup(popupContent, { maxHeight: 200 , maxWidth: 400})
        layer.bindTooltip(tooltipContent, { permanent: false, direction: 'right'});
        if (feature.properties['mine feature category'] == "mine boundary") {
           layer.setStyle({ color: '#CA4A50', fillColor: '#CA4A50', opacity: 1.0 });
        }
        markerLayerGroup.addLayer(layer)
	}
    
    markerLayerGroup.addTo(map);
    const mineLayer = L.geoJSON(mine, {onEachFeature}).addTo(map)
    var GEMMineIcon = L.icon({ iconUrl: 'https://maps.google.com/mapfiles/kml/paddle/red-circle.png', iconSize:  [40, 40]});
    
    const myDiv = document.getElementById('map');
    const width = myDiv.offsetWidth;
    const height = myDiv.offsetHeight;
    console.log("#map width: " + width + ", height: " + height);                    

    // Create a "dummy" layer group specifically to act as the tooltip toggle switch in the control
    var tooltipToggleLayer = L.layerGroup();
    // Add event listeners to the map that listen for the toggle layer being added or removed
    map.on('layeradd', function (e) {
        if (e.layer === tooltipToggleLayer) {
            // When the "Tooltip" overlay is selected, iterate over all markers and make tooltips permanent
            markerLayerGroup.eachLayer(function (layer) {
                if (layer.getTooltip()) {
                    layer.getTooltip().options.permanent = true;
                    layer.openTooltip(); // Open the tooltip permanently
                }
            });
        }
    });
    map.on('layerremove', function (e) {
        if (e.layer === tooltipToggleLayer) {
            // When the "Tooltip" overlay is deselected, make tooltips non-permanent and close them
            markerLayerGroup.eachLayer(function (layer) {
                if (layer.getTooltip()) {
                    layer.getTooltip().options.permanent = false;
                    layer.closeTooltip();
                }
            });
        }
    });

    map.on('zoomend', function() {
        console.log("Current zoom level: " + map.getZoom());
    });

    var baseMaps = {
        "Satellite view": googleHybrid,
        "Street view": googleStreet
    };
    var overlayMaps = {
        "Labels": tooltipToggleLayer // The toggle switch for tooltips
    };
    var layerControl = L.control.layers(baseMaps, overlayMaps).addTo(map);
                        
    var GEMMine;
                        
    GEMMine = L.marker([-24.6168211, 150.0504833], {icon: GEMMineIcon}).addTo(map); 
    GEMMine.bindPopup("Operating status(es): Operating");
    GEMMine.bindTooltip("Dawson Complex", { permanent: true, direction: 'right'});
